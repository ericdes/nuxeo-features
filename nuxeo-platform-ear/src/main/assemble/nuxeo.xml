<assembly>

  <!-- RESOURCES -->
  <assemble>
    <set>resources</set>
    <outputFile>/</outputFile>
  </assemble>
  <zipEntrySet id="resources">
    <artifact>org.nuxeo.ecm.platform:nuxeo-platform-ear:${project.version}:zip:resources-mono</artifact>
  </zipEntrySet>

  <!-- ARTIFACTS -->
  <assemble>
    <outputFile>/</outputFile>
    <set>root-artifacts</set>
  </assemble>
  <artifactSet id="root-artifacts">
    <import>**</import>
    <includeDependencies>false</includeDependencies>
    <includes>
      <artifact name="nuxeo-platform-webapp" />
      <artifact name="nuxeo-platform-webapp-core" />
    </includes>
  </artifactSet>

  <assemble>
    <outputFile>system</outputFile>
    <set>system</set>
  </assemble>
  <artifactSet id="system">
    <import>**</import>
    <includeDependencies>true</includeDependencies>
    <includes>
      <artifact group="org.nuxeo.*" category="runtime,jboss4"
        includeDependsOnCategory="false" />
      <artifact group="org.nuxeo.*" category="core,search,web" />
      <!-- nuxeo-addons -->
    </includes>
    <excludes>
      <artifact group="!org.nuxeo*" />
      <artifact name="nuxeo-common" />
      <artifact name="nuxeo-runtime-jboss-extensions" />

      <artifact name="nuxeo-platform-webapp" />
      <artifact name="nuxeo-platform-webapp-core" />

      <artifact name="nuxeo-platform-audit-facade" />
      <artifact name="nuxeo-platform-placeful-facade" />
      <artifact name="nuxeo-platform-search-compass-plugin" />
      <artifact name="nuxeo-platform-ear" />
      <artifact name="nuxeo-apt-extensions" />
    </excludes>
  </artifactSet>

  <assemble>
    <outputFile>system</outputFile>
    <unpack>true</unpack>
    <unpackInNewDirectory>true</unpackInNewDirectory>
    <set>nuxeo-platform-unpacked</set>
  </assemble>
  <artifactSet id="nuxeo-platform-unpacked">
    <import>**</import>
    <includes>
      <artifact name="nuxeo-platform-audit-facade" />
      <artifact name="nuxeo-platform-placeful-facade" />
      <artifact name="nuxeo-platform-search-compass-plugin" />
    </includes>
  </artifactSet>

  <!-- third party libraries embedded in the ear -->
  <assemble>
    <outputFile>lib</outputFile>
    <set>nuxeo-fixed-libs</set>
  </assemble>
  <artifactSet id="nuxeo-fixed-libs">
    <artifacts>
      <artifact group="org.freemarker" name="freemarker" version="2.3.11" />
      <artifact group="org.osgi" name="osgi-core" version="4.1" />
      <artifact group="commons-collections" name="commons-collections"
        version="3.1" />
      <artifact group="commons-io" name="commons-io" version="1.2" />
      <artifact group="commons-lang" name="commons-lang" version="2.2" />
      <artifact group="commons-fileupload" name="commons-fileupload"
        version="1.1.1" />
      <artifact group="cssparser" name="cssparser" version="0.9.4-fix" />
      <artifact group="net.sf.ehcache" name="ehcache" version="1.2.3" />
      <artifact group="net.sf.ezmorph" name="ezmorph" version="0.9" />
      <artifact group="org.hibernate" name="hibernate" version="3.2.0.ga" />
      <artifact group="org.hibernate" name="hibernate-annotations"
        version="3.2.0.ga" />
      <artifact group="org.hibernate" name="hibernate-entitymanager"
        version="3.2.0.ga" />
      <artifact group="jboss" name="jboss-cache-jdk50" version="1.4.0.SP1" />
      <artifact group="org.jboss.seam" name="jboss-seam" version="2.0.3.CR1-NX2" />
      <artifact group="org.jboss.seam" name="jboss-seam-remoting"
        version="2.0.3.CR1" />
      <artifact group="org.jboss.seam" name="jboss-seam-ui" version="2.0.3.CR1" />
      <artifact group="org.jboss.seam" name="jboss-seam-mail"
        version="2.0.3.CR1" />
      <artifact group="org.jboss.seam" name="jboss-seam-debug"
        version="2.0.3.CR1" />
      <artifact group="org.jboss.el" name="jboss-el" version="2.0.1.GA" />
      <artifact group="jboss" name="jbpm" version="3.1.4" />
      <artifact group="jboss" name="jgroups" version="2.2.9" />
      <artifact group="net.sf.json-lib" name="json-lib" version="0.9" />
      <artifact group="org.apache.lucene" name="lucene-core" version="2.0.0" />
      <artifact group="net.sf.opencsv" name="opencsv" version="1.7" />
      <artifact group="org.slf4j" name="slf4j-api" version="1.3.0" />
      <artifact group="org.slf4j" name="slf4j-log4j12" version="1.3.0" />
      <artifact group="org.richfaces.framework" name="richfaces-api"
        version="3.2.1.GA" />
      <artifact group="org.richfaces.framework" name="richfaces-impl"
        version="3.2.1.GA-NX" />
      <artifact group="org.richfaces.ui" name="richfaces-ui" version="3.2.1.GA" />
      <artifact group="org.apache.directory.server"
        name="apacheds-protocol-shared" version="1.5.1" />
      <artifact group="org.apache.directory.shared" name="shared-ldap"
        version="0.9.7" />
      <artifact group="com.sun.facelets" name="jsf-facelets" version="1.1.11" />
      <artifact group="org.nuxeo.ecm.platform" name="nuxeo-jbossws-wrapper"
        version="4.0.5.GA" />
      <artifact group="javax.el" name="el-ri" version="unknown"/>
    </artifacts>
  </artifactSet>

  <!-- third party libraries based on dependencies
    <assemble>
    <outputFile>lib2</outputFile>
    <set>nuxeo-libs-via-dependency-tree</set>
    </assemble>
    <artifactSet id="nuxeo-libs-via-dependency-tree">
    <import>**</import>
    <includeDependencies>true</includeDependencies>
    <includes>
    <artifact scope="compile" />
    </includes>
    <excludes>
    <artifact group="org.nuxeo.*" />
    </excludes>
    </artifactSet>
  -->

  <!-- CUSTOM RESOURCES
    <assemble>
    <outputFile>/</outputFile>
    <set>custom-resources</set>
    </assemble>
    <fileSet id="custom-resources">
    <directory>src/main/resources_custom</directory>
    </fileSet>
  -->

  <!-- CUSTOM ARTIFACTS
    <assemble>
    <outputFile>plugins</outputFile>
    <set>custom-plugins</set>
    </assemble>
    <artifactSet id="custom-plugins">
    <import>**</import>
    <includeDependencies>false</includeDependencies>
    <includes>
    <artifact group="com.custom.sample" />
    </includes>
    </artifactSet>
  -->
</assembly>
