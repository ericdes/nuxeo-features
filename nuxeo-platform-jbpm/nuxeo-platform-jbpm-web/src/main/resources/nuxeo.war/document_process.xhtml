<div xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core" xmlns:h="http://java.sun.com/jsf/html"
  xmlns:c="http://java.sun.com/jstl/core"
  xmlns:a4j="https://ajax4jsf.dev.java.net/ajax">
  <!-- Process -->
  <c:set var="processes" value="#{jbpmService.getProcessInstances(currentDocument, currentUser)}"/>
  <c:choose>
    <c:when test="#{empty processes}">
      <h:form>
      <h:selectOneMenu id="selectPD" value="#{selectedPD}">
        <c:forEach var="pd" items="#{jbpmService.getProcessDefinitions(currentUser, currentDocument)}">
          <f:selectItem itemLabel="#{pd.name}" itemValue="#{pd.name}"/>
        </c:forEach>
      </h:selectOneMenu>
      <h:commandButton style="button"
                        value="#{messages['jbpm.processview.newpdInstance']}"
                        action="#{jbpmService.createProcessInstance(currentUser, selectedPD, currentDocument)}"/>
      </h:form>
    </c:when>
    <c:when test="#{processes.size() == 1}">
     <c:set var="process" value="#{processes.get(0)}"/>
     <ui:decorate template="/process/#{process.processDefinition.name}.xhtml">
       <ui:param name="process" value="#{process}"/>
     </ui:decorate>
    </c:when>
  </c:choose>
  <!-- Tasks -->
  <c:set var="tasks" value="#{jbpmService.getTaskInstances(currentDocument, currentUser)}"/>
  <c:choose>
    <c:when test="#{empty tasks}">
    no task
    </c:when>
    <c:otherwise>
    tasks
    </c:otherwise>
  </c:choose>
</div>